### [C++ Concurrency 并发相关概念原理](#)
**介绍**： 先有概念再有实现，如果不明白各个概念那么学习并发设计是很困难的，这就变成了记API了， 我们学习的应该是C++对并发相关概念的的实现。

-----
使用并发技术的目的: **1.  分立关注点**  **2. 性能提升**  并发编程也有代价不能为了并发而并发！

**分立关注点**:  例如一个桌面音乐软件, UI线程负责UI显示和渲染，网络线程负责请求音乐资源，音频线程负责播放音乐，格式转换，主线程负责各种操作响应，捕获用户输入。
这样就不会发生，用户点一下下一首，单个线程先捕获操作，再请求资源，再解析转换音乐播放格式，最后再进行UI响应！这样做界面就会呈现卡顿的效果！ UI半天没有结果！

**性能提升**: 自从多核CPU称为主流以来，如果程序想要利用不断增强的计算机处理能力，就必须将软件设计为并发运行任务！


### [Concurrency and Parallelism](#)

并发和并行本质上都是基于CPU任务的快速切换！**多个程序的并发并行依靠操作系统进程调度实现，自从操作系统支持线程/协程以来，并发的单位就从进程变成了线程/协程！** 也就是可以这样说，**一个程序的并发和并行依靠多线程来实现！** 也就说是并发有两种方式：**多进程并发、多线程并发！**

**并发**:  在操作系统中，是指一个时间段中有几个程序都处于已启动运行到运行完毕之间！ 单核或者多核CPU都可以实现并发！

**并行**: 在操作系统中，一组程序按独立异步的速度执行，无论从微观还是宏观，程序都是一起执行的。只有多核CPU才有并行！  **也可以称为: 硬件并发**



> 并发和并行很多程序上是重叠的，他们的差别很小，并发更强调隔离，分立关注点和响应能力，并行更强调性能！

#### Multi process concurrency

**多进程并发**：在一个计算机上面的进程之间按照OS调度方式，交替在CPU上面执行，进程之间使用 **进程间通信的方式进行信息交流！** 并且独立的进程可以在不同的计算机上面运行！还可以利用网络进行通信！利用分布式系统级别的算力资源！

* 问题1，进程的开销大！



#### Multi thread concurrency

**多线程并发**：在单一进程内部将任务进行划分，使用多线程来运行，线程之间共享进程的大部分数据，同一进程的所有线程都共用相同的地址空间。指向对象或者数据的指针、引用可以在多个线程之间传递。

* 多个线程之间的运行顺序和关系会延伸出同步异步问题

可以同时完成多个任务；可以使程序的响应速度更快；可以让占用大量处理时间的任务或当前没有进行处理的任务定期将处理时间让给别的任务；可以随时停止任务；可以设置每个任务的优先级以优化程序性能。



### [Disadvantages of concurrency](#)

1. 线程的启动和切换具有固定开销！

2. 如果线程任务太快完成，处理任务本身的时间就会短于线程启动的时间，导致系统整体性能下降！

3. **每个线程都需要独立的栈空间**，线程过多会耗尽进程可用的内存和地址空间。

4. 运行的线程越多，OS所做的上下文切换就越频繁！

   

### [Synchronous and Asynchronous](#)

**同步**:进程之间的关系 **不是相互排斥临界资源的关系**，**而是相互依赖的关系**。进一步的说明：就是前一个进程的输出作为后一个进程的输 入，当第一个进程没有输出时第二个进程必须等待。具有同步关系的一组并发进程相互发送的信息称为消息或事件。

**异步**：异步和同步是相对的，同步就是顺序执行，执行完一个再执行下一个，需要等待、协调运行。异步就是彼此独立,在等待 某事件的过程中继续做自己的事，不需要等待这一事件完成后再工作

**互斥**: 进程间相互排斥的使用临界资源的现象，就叫互斥。

